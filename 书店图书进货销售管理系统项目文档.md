# ä¹¦åº—å›¾ä¹¦è¿›è´§é”€å”®ç®¡ç†ç³»ç»Ÿé¡¹ç›®æ–‡æ¡£

## ç›®å½•
1. [éœ€æ±‚åˆ†æ (10%)](#1-éœ€æ±‚åˆ†æ)
2. [æ•°æ®åº“è®¾è®¡ï¼ˆç»“æ„ã€ä¼˜åŒ–ï¼‰(15%)](#2-æ•°æ®åº“è®¾è®¡)
3. [å®Œæ•´æ€§ (5%)](#3-å®Œæ•´æ€§)
4. [å®‰å…¨æ€§ (5%)](#4-å®‰å…¨æ€§)
5. [è§†å›¾çš„è®¾è®¡ä¸ä½¿ç”¨ (10%)](#5-è§†å›¾çš„è®¾è®¡ä¸ä½¿ç”¨)
6. [è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çš„è®¾è®¡ä¸è¿ç”¨ (10%)](#6-è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çš„è®¾è®¡ä¸è¿ç”¨)
7. [ç´¢å¼• (5%)](#7-ç´¢å¼•)
8. [ç³»ç»ŸåŠŸèƒ½å®ç° (30%)](#8-ç³»ç»ŸåŠŸèƒ½å®ç°)
9. [ç³»ç»Ÿç•Œé¢çš„å‹å¥½æ€§ (10%)](#9-ç³»ç»Ÿç•Œé¢çš„å‹å¥½æ€§)

---

## 1. éœ€æ±‚åˆ†æ

### 1.1 é¡¹ç›®èƒŒæ™¯
æœ¬ç³»ç»Ÿæ˜¯ä¸ºä¹¦åº—ä¸šåŠ¡é‡èº«å®šåˆ¶çš„è¿›è´§é”€å”®ç®¡ç†ç³»ç»Ÿï¼ŒåŸºäºè‹¥ä¾æ¡†æ¶å¼€å‘ï¼Œæ—¨åœ¨æä¾›å®Œæ•´çš„å›¾ä¹¦è¿›è´§ã€åº“å­˜ç®¡ç†ã€é”€å”®ç»Ÿè®¡ç­‰åŠŸèƒ½ï¼Œæ”¯æŒå¤šä»“åº“ç®¡ç†ã€è‡ªåŠ¨åº“å­˜æ›´æ–°ã€é”€å”®æ•°æ®åˆ†æç­‰æ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½ã€‚

### 1.2 åŠŸèƒ½éœ€æ±‚

#### 1.2.1 åŸºç¡€ä¿¡æ¯ç®¡ç†
- **å›¾ä¹¦ç±»åˆ«ç®¡ç†**ï¼šç»´æŠ¤å›¾ä¹¦åˆ†ç±»ä¿¡æ¯ï¼Œæ”¯æŒåˆ†ç±»çš„å¢åˆ æ”¹æŸ¥
- **å‡ºç‰ˆç¤¾ç®¡ç†**ï¼šç®¡ç†å‡ºç‰ˆç¤¾åŸºæœ¬ä¿¡æ¯
- **å›¾ä¹¦ä¿¡æ¯ç®¡ç†**ï¼šç®¡ç†å›¾ä¹¦çš„åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä¹¦åã€ä½œè€…ã€ç±»åˆ«ã€å‡ºç‰ˆç¤¾ã€è¿›è´§ä»·ã€é›¶å”®ä»·ã€åº“å­˜ç­‰
- **ä»“åº“ä¿¡æ¯ç®¡ç†**ï¼šç®¡ç†å¤šä¸ªä»“åº“çš„åŸºæœ¬ä¿¡æ¯

#### 1.2.2 ä¸šåŠ¡æµç¨‹ç®¡ç†
- **è¿›è´§ç®¡ç†**ï¼šå¤„ç†å›¾ä¹¦è¿›è´§ä¸šåŠ¡ï¼Œæ”¯æŒä¸€å•å¤šç§å›¾ä¹¦
- **å…¥åº“ç®¡ç†**ï¼šè‡ªåŠ¨æ›´æ–°åº“å­˜ä¿¡æ¯
- **é”€å”®ç®¡ç†**ï¼šå¤„ç†å›¾ä¹¦é”€å”®ä¸šåŠ¡ï¼Œæ”¯æŒä¸€å•å¤šç§å›¾ä¹¦
- **å‡ºåº“ç®¡ç†**ï¼šè‡ªåŠ¨å‡å°‘åº“å­˜

#### 1.2.3 æ•°æ®ç»Ÿè®¡ä¸æŸ¥è¯¢
- **åº“å­˜æŸ¥è¯¢**ï¼šæŸ¥è¯¢å„ç±»å›¾ä¹¦çš„åº“å­˜æ€»æ•°
- **è¿›é”€å­˜ç»Ÿè®¡**ï¼šæŸ¥è¯¢æŸæ®µæ—¶é—´å†…å„ç§å›¾ä¹¦çš„è¿›è´§å’Œé”€å”®æƒ…å†µ
- **æ•°æ®åˆ†æ**ï¼šæä¾›é”€å”®æ•°æ®åˆ†æå’Œç»Ÿè®¡æŠ¥è¡¨

#### 1.2.4 ç³»ç»Ÿç®¡ç†
- **æ•°æ®å¤‡ä»½**ï¼šæ”¯æŒæ•°æ®åº“å¤‡ä»½åŠŸèƒ½
- **æ•°æ®æ¢å¤**ï¼šæ”¯æŒæ•°æ®åº“æ¢å¤åŠŸèƒ½
- **æƒé™ç®¡ç†**ï¼šåŸºäºè§’è‰²çš„æƒé™æ§åˆ¶

### 1.3 éåŠŸèƒ½æ€§éœ€æ±‚
- **æ€§èƒ½è¦æ±‚**ï¼šç³»ç»Ÿå“åº”æ—¶é—´ä¸è¶…è¿‡3ç§’
- **å®‰å…¨è¦æ±‚**ï¼šç”¨æˆ·èº«ä»½è®¤è¯ã€æ•°æ®åŠ å¯†ä¼ è¾“
- **å¯ç”¨æ€§è¦æ±‚**ï¼š7Ã—24å°æ—¶ç¨³å®šè¿è¡Œ
- **æ‰©å±•æ€§è¦æ±‚**ï¼šæ”¯æŒä¸šåŠ¡è§„æ¨¡æ‰©å±•

---

## 2. æ•°æ®åº“è®¾è®¡

### 2.1 æ•°æ®åº“ç»“æ„è®¾è®¡

#### 2.1.1 æ ¸å¿ƒä¸šåŠ¡è¡¨

**1. å›¾ä¹¦ç±»åˆ«è¡¨ (tb_book_category)**
```sql
CREATE TABLE tb_book_category (
    category_id BIGINT PRIMARY KEY,
    category_name VARCHAR(100) NOT NULL,
    description TEXT
);
```

**2. å‡ºç‰ˆç¤¾è¡¨ (tb_publisher)**
```sql
CREATE TABLE tb_publisher (
    publisher_id BIGINT PRIMARY KEY,
    publisher_name VARCHAR(200) NOT NULL,
    address VARCHAR(500),
    contact_phone VARCHAR(20)
);
```

**3. å›¾ä¹¦ä¿¡æ¯è¡¨ (tb_book)**
```sql
CREATE TABLE tb_book (
    book_id BIGINT PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    author VARCHAR(100),
    category_id BIGINT,
    publisher_id BIGINT,
    purchase_price DECIMAL(10,2),
    retail_price DECIMAL(10,2),
    total_stock BIGINT DEFAULT 0,
    FOREIGN KEY (category_id) REFERENCES tb_book_category(category_id),
    FOREIGN KEY (publisher_id) REFERENCES tb_publisher(publisher_id)
);
```

**4. ä»“åº“è¡¨ (tb_warehouse)**
```sql
CREATE TABLE tb_warehouse (
    warehouse_id BIGINT PRIMARY KEY,
    warehouse_name VARCHAR(100) NOT NULL,
    location VARCHAR(200),
    manager VARCHAR(50)
);
```

**5. åº“å­˜è¡¨ (tb_inventory)**
```sql
CREATE TABLE tb_inventory (
    inventory_id BIGINT PRIMARY KEY,
    book_id BIGINT,
    warehouse_id BIGINT,
    quantity BIGINT DEFAULT 0,
    FOREIGN KEY (book_id) REFERENCES tb_book(book_id),
    FOREIGN KEY (warehouse_id) REFERENCES tb_warehouse(warehouse_id)
);
```

**6. è¿›è´§è®¢å•ä¸»è¡¨ (tb_purchase_order)**
```sql
CREATE TABLE tb_purchase_order (
    order_id BIGINT PRIMARY KEY,
    order_date DATE NOT NULL
);
```

**7. è¿›è´§æ˜ç»†è¡¨ (tb_purchase_detail)**
```sql
CREATE TABLE tb_purchase_detail (
    detail_id BIGINT PRIMARY KEY,
    order_id BIGINT,
    book_id BIGINT,
    warehouse_id BIGINT,
    quantity BIGINT NOT NULL,
    unit_price DECIMAL(10,2),
    FOREIGN KEY (order_id) REFERENCES tb_purchase_order(order_id),
    FOREIGN KEY (book_id) REFERENCES tb_book(book_id),
    FOREIGN KEY (warehouse_id) REFERENCES tb_warehouse(warehouse_id)
);
```

**8. é”€å”®è®¢å•ä¸»è¡¨ (tb_sales_order)**
```sql
CREATE TABLE tb_sales_order (
    order_id BIGINT PRIMARY KEY,
    order_date DATE NOT NULL
);
```

**9. é”€å”®æ˜ç»†è¡¨ (tb_sales_detail)**
```sql
CREATE TABLE tb_sales_detail (
    detail_id BIGINT PRIMARY KEY,
    order_id BIGINT,
    book_id BIGINT,
    warehouse_id BIGINT,
    quantity BIGINT NOT NULL,
    unit_price DECIMAL(10,2),
    FOREIGN KEY (order_id) REFERENCES tb_sales_order(order_id),
    FOREIGN KEY (book_id) REFERENCES tb_book(book_id),
    FOREIGN KEY (warehouse_id) REFERENCES tb_warehouse(warehouse_id)
);
```

### 2.2 æ•°æ®åº“ä¼˜åŒ–è®¾è®¡

#### 2.2.1 ç´¢å¼•ä¼˜åŒ–
- åœ¨å¤–é”®å­—æ®µä¸Šåˆ›å»ºç´¢å¼•ï¼Œæé«˜å…³è”æŸ¥è¯¢æ€§èƒ½
- åœ¨ç»å¸¸æŸ¥è¯¢çš„å­—æ®µä¸Šåˆ›å»ºå¤åˆç´¢å¼•
- å¯¹æ—¥æœŸå­—æ®µåˆ›å»ºç´¢å¼•ï¼Œä¼˜åŒ–æ—¶é—´èŒƒå›´æŸ¥è¯¢

#### 2.2.2 åˆ†åŒºç­–ç•¥
- å¯¹å¤§æ•°æ®é‡çš„è®¢å•è¡¨æŒ‰æ—¶é—´è¿›è¡Œåˆ†åŒº
- æé«˜æŸ¥è¯¢å’Œç»´æŠ¤æ•ˆç‡

#### 2.2.3 æ•°æ®ç±»å‹ä¼˜åŒ–
- ä½¿ç”¨åˆé€‚çš„æ•°æ®ç±»å‹ï¼Œé¿å…å­˜å‚¨ç©ºé—´æµªè´¹
- ä»·æ ¼å­—æ®µä½¿ç”¨DECIMALç±»å‹ä¿è¯ç²¾åº¦
- æ•°é‡å­—æ®µä½¿ç”¨BIGINTæ”¯æŒå¤§æ•°å€¼

---

## 3. å®Œæ•´æ€§

### 3.1 å®ä½“å®Œæ•´æ€§
- æ‰€æœ‰ä¸»è¡¨éƒ½å®šä¹‰äº†ä¸»é”®çº¦æŸ
- ä¸»é”®å­—æ®µä¸å…è®¸ä¸ºç©ºä¸”å”¯ä¸€
- ä½¿ç”¨è‡ªå¢é•¿ä¸»é”®ä¿è¯å”¯ä¸€æ€§

### 3.2 å‚ç…§å®Œæ•´æ€§
- å®šä¹‰å¤–é”®çº¦æŸç¡®ä¿æ•°æ®ä¸€è‡´æ€§
- å›¾ä¹¦è¡¨å¼•ç”¨ç±»åˆ«è¡¨å’Œå‡ºç‰ˆç¤¾è¡¨
- åº“å­˜è¡¨å¼•ç”¨å›¾ä¹¦è¡¨å’Œä»“åº“è¡¨
- è®¢å•æ˜ç»†è¡¨å¼•ç”¨è®¢å•ä¸»è¡¨ã€å›¾ä¹¦è¡¨å’Œä»“åº“è¡¨

### 3.3 åŸŸå®Œæ•´æ€§
- è®¾ç½®å­—æ®µçš„æ•°æ®ç±»å‹çº¦æŸ
- ä»·æ ¼å­—æ®µä½¿ç”¨DECIMAL(10,2)ç¡®ä¿ç²¾åº¦
- æ•°é‡å­—æ®µè®¾ç½®éè´Ÿçº¦æŸ
- å¿…å¡«å­—æ®µè®¾ç½®NOT NULLçº¦æŸ

### 3.4 ç”¨æˆ·å®šä¹‰å®Œæ•´æ€§
- é€šè¿‡è§¦å‘å™¨å®ç°ä¸šåŠ¡è§„åˆ™çº¦æŸ
- åº“å­˜æ•°é‡ä¸èƒ½ä¸ºè´Ÿæ•°
- é”€å”®æ•°é‡ä¸èƒ½è¶…è¿‡åº“å­˜æ•°é‡
- ä»·æ ¼å¿…é¡»å¤§äº0

---

## 4. å®‰å…¨æ€§

### 4.1 èº«ä»½è®¤è¯
- åŸºäºSpring Securityæ¡†æ¶å®ç°ç”¨æˆ·è®¤è¯
- æ”¯æŒç”¨æˆ·åå¯†ç ç™»å½•
- å¯†ç ä½¿ç”¨BCryptåŠ å¯†å­˜å‚¨
- JWT Tokenæœºåˆ¶å®ç°æ— çŠ¶æ€è®¤è¯

### 4.2 æƒé™æ§åˆ¶
- åŸºäºRBACï¼ˆè§’è‰²è®¿é—®æ§åˆ¶ï¼‰æ¨¡å‹
- ç»†ç²’åº¦çš„æƒé™æ§åˆ¶åˆ°å…·ä½“æ“ä½œ
- ä½¿ç”¨@PreAuthorizeæ³¨è§£è¿›è¡Œæ–¹æ³•çº§æƒé™æ§åˆ¶
- å‰ç«¯è·¯ç”±æƒé™æ§åˆ¶

### 4.3 æ•°æ®å®‰å…¨
- æ•°æ®ä¼ è¾“ä½¿ç”¨HTTPSåŠ å¯†
- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤

### 4.4 å®¡è®¡æ—¥å¿—
- è®°å½•ç”¨æˆ·æ“ä½œæ—¥å¿—
- è®°å½•æ•°æ®å˜æ›´å†å²
- å¼‚å¸¸è®¿é—®ç›‘æ§
- ç³»ç»Ÿè¿è¡Œæ—¥å¿—

### 4.5 æ•°æ®å¤‡ä»½ä¸æ¢å¤
- å®šæœŸè‡ªåŠ¨å¤‡ä»½æ•°æ®åº“
- æ”¯æŒæ‰‹åŠ¨å¤‡ä»½æ“ä½œ
- æä¾›æ•°æ®æ¢å¤åŠŸèƒ½
- å¤‡ä»½æ–‡ä»¶åŠ å¯†å­˜å‚¨

---

## 5. è§†å›¾çš„è®¾è®¡ä¸ä½¿ç”¨

### 5.1 å„ç±»å›¾ä¹¦åº“å­˜æ€»æ•°è§†å›¾

```sql
CREATE VIEW vw_CategoryInventory AS
SELECT 
    bc.category_id,
    bc.category_name,
    COALESCE(SUM(b.total_stock), 0) as total_inventory
FROM tb_book_category bc
LEFT JOIN tb_book b ON bc.category_id = b.category_id
GROUP BY bc.category_id, bc.category_name;
```

### 5.2 è§†å›¾çš„ä½¿ç”¨åœºæ™¯
- **åº“å­˜ç»Ÿè®¡æŠ¥è¡¨**ï¼šå¿«é€ŸæŸ¥è¯¢å„ç±»å›¾ä¹¦çš„åº“å­˜æ€»æ•°
- **æ•°æ®åˆ†æ**ï¼šä¸ºç®¡ç†å±‚æä¾›åº“å­˜åˆ†å¸ƒæƒ…å†µ
- **ä¸šåŠ¡å†³ç­–**ï¼šè¾…åŠ©é‡‡è´­å†³ç­–å’Œåº“å­˜ç®¡ç†

### 5.3 è§†å›¾çš„ä¼˜åŠ¿
- **ç®€åŒ–æŸ¥è¯¢**ï¼šå°†å¤æ‚çš„å…³è”æŸ¥è¯¢å°è£…ä¸ºç®€å•çš„è§†å›¾æŸ¥è¯¢
- **æ•°æ®å®‰å…¨**ï¼šéšè—åº•å±‚è¡¨ç»“æ„ï¼Œåªæš´éœ²å¿…è¦çš„æ•°æ®
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé¢„è®¡ç®—ç»Ÿè®¡æ•°æ®ï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡
- **ç»´æŠ¤ä¾¿åˆ©**ï¼šç»Ÿä¸€æ•°æ®è®¿é—®æ¥å£ï¼Œä¾¿äºç»´æŠ¤

---

## 6. è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çš„è®¾è®¡ä¸è¿ç”¨

### 6.1 è§¦å‘å™¨è®¾è®¡

#### 6.1.1 è¿›è´§å…¥åº“è§¦å‘å™¨
```sql
CREATE TRIGGER trg_AfterInsertPurchaseDetail
AFTER INSERT ON tb_purchase_detail
FOR EACH ROW
BEGIN
    -- æ›´æ–°å›¾ä¹¦æ€»åº“å­˜
    UPDATE tb_book 
    SET total_stock = total_stock + NEW.quantity 
    WHERE book_id = NEW.book_id;
    
    -- æ›´æ–°ä»“åº“åº“å­˜
    INSERT INTO tb_inventory (book_id, warehouse_id, quantity)
    VALUES (NEW.book_id, NEW.warehouse_id, NEW.quantity)
    ON DUPLICATE KEY UPDATE quantity = quantity + NEW.quantity;
END;
```

#### 6.1.2 é”€å”®å‡ºåº“è§¦å‘å™¨
```sql
CREATE TRIGGER trg_AfterInsertSalesDetail
AFTER INSERT ON tb_sales_detail
FOR EACH ROW
BEGIN
    -- æ›´æ–°å›¾ä¹¦æ€»åº“å­˜
    UPDATE tb_book 
    SET total_stock = total_stock - NEW.quantity 
    WHERE book_id = NEW.book_id;
    
    -- æ›´æ–°ä»“åº“åº“å­˜
    UPDATE tb_inventory 
    SET quantity = quantity - NEW.quantity 
    WHERE book_id = NEW.book_id AND warehouse_id = NEW.warehouse_id;
    
    -- å¦‚æœåº“å­˜æ¸…é›¶ï¼Œåˆ é™¤è¯¥æ¡è®°å½•
    DELETE FROM tb_inventory 
    WHERE book_id = NEW.book_id 
      AND warehouse_id = NEW.warehouse_id 
      AND quantity = 0;
END;
```

**è§¦å‘å™¨åŠŸèƒ½è¯´æ˜**ï¼š
- è‡ªåŠ¨å‡å°‘å›¾ä¹¦æ€»åº“å­˜
- æ›´æ–°å¯¹åº”ä»“åº“çš„åº“å­˜æ•°é‡
- **æ–°å¢åŠŸèƒ½**ï¼šå½“æŸä»“åº“æŸå›¾ä¹¦åº“å­˜æ¸…é›¶æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤tb_inventoryä¸­çš„å¯¹åº”è®°å½•ï¼Œé¿å…äº§ç”Ÿquantity=0çš„å†—ä½™æ•°æ®

### 6.2 å­˜å‚¨è¿‡ç¨‹è®¾è®¡

#### 6.2.1 å›¾ä¹¦è¿›é”€å­˜ç»Ÿè®¡å­˜å‚¨è¿‡ç¨‹
```sql
CREATE PROCEDURE sp_GetBookInventoryStats(
    IN start_date DATE,
    IN end_date DATE,
    IN page_num INT,
    IN page_size INT
)
BEGIN
    DECLARE offset_val INT DEFAULT 0;
    SET offset_val = (page_num - 1) * page_size;
    
    SELECT 
        b.book_id,
        b.title,
        b.author,
        bc.category_name,
        p.publisher_name,
        COALESCE(purchase_stats.total_purchase, 0) as total_purchase,
        COALESCE(sales_stats.total_sales, 0) as total_sales,
        b.total_stock as current_stock
    FROM tb_book b
    LEFT JOIN tb_book_category bc ON b.category_id = bc.category_id
    LEFT JOIN tb_publisher p ON b.publisher_id = p.publisher_id
    LEFT JOIN (
        SELECT pd.book_id, SUM(pd.quantity) as total_purchase
        FROM tb_purchase_detail pd
        JOIN tb_purchase_order po ON pd.order_id = po.order_id
        WHERE po.order_date BETWEEN start_date AND end_date
        GROUP BY pd.book_id
    ) purchase_stats ON b.book_id = purchase_stats.book_id
    LEFT JOIN (
        SELECT sd.book_id, SUM(sd.quantity) as total_sales
        FROM tb_sales_detail sd
        JOIN tb_sales_order so ON sd.order_id = so.order_id
        WHERE so.order_date BETWEEN start_date AND end_date
        GROUP BY sd.book_id
    ) sales_stats ON b.book_id = sales_stats.book_id
    ORDER BY b.book_id
    LIMIT page_size OFFSET offset_val;
END;
```

### 6.3 è§¦å‘å™¨ä¸å­˜å‚¨è¿‡ç¨‹çš„ä¼˜åŠ¿
- **æ•°æ®ä¸€è‡´æ€§**ï¼šè‡ªåŠ¨ç»´æŠ¤åº“å­˜æ•°æ®çš„ä¸€è‡´æ€§
- **ä¸šåŠ¡é€»è¾‘å°è£…**ï¼šå°†å¤æ‚çš„ä¸šåŠ¡é€»è¾‘å°è£…åœ¨æ•°æ®åº“å±‚
- **æ€§èƒ½ä¼˜åŒ–**ï¼šå‡å°‘åº”ç”¨å±‚ä¸æ•°æ®åº“çš„äº¤äº’æ¬¡æ•°
- **äº‹åŠ¡å®Œæ•´æ€§**ï¼šç¡®ä¿ç›¸å…³æ“ä½œçš„åŸå­æ€§

---

## 7. ç´¢å¼•

### 7.1 ä¸»é”®ç´¢å¼•
- æ‰€æœ‰è¡¨çš„ä¸»é”®è‡ªåŠ¨åˆ›å»ºèšé›†ç´¢å¼•
- æä¾›æœ€å¿«çš„æ•°æ®è®¿é—®é€Ÿåº¦

### 7.2 å¤–é”®ç´¢å¼•
```sql
-- å›¾ä¹¦è¡¨å¤–é”®ç´¢å¼•
CREATE INDEX idx_book_category ON tb_book(category_id);
CREATE INDEX idx_book_publisher ON tb_book(publisher_id);

-- åº“å­˜è¡¨å¤–é”®ç´¢å¼•
CREATE INDEX idx_inventory_book ON tb_inventory(book_id);
CREATE INDEX idx_inventory_warehouse ON tb_inventory(warehouse_id);

-- è®¢å•æ˜ç»†è¡¨å¤–é”®ç´¢å¼•
CREATE INDEX idx_purchase_detail_order ON tb_purchase_detail(order_id);
CREATE INDEX idx_purchase_detail_book ON tb_purchase_detail(book_id);
CREATE INDEX idx_sales_detail_order ON tb_sales_detail(order_id);
CREATE INDEX idx_sales_detail_book ON tb_sales_detail(book_id);
```

### 7.3 å¤åˆç´¢å¼•
```sql
-- åº“å­˜è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_inventory_book_warehouse ON tb_inventory(book_id, warehouse_id);

-- è®¢å•æ˜ç»†è¡¨å¤åˆç´¢å¼•
CREATE INDEX idx_purchase_detail_book_warehouse ON tb_purchase_detail(book_id, warehouse_id);
CREATE INDEX idx_sales_detail_book_warehouse ON tb_sales_detail(book_id, warehouse_id);
```

### 7.4 æ—¥æœŸç´¢å¼•
```sql
-- è®¢å•æ—¥æœŸç´¢å¼•
CREATE INDEX idx_purchase_order_date ON tb_purchase_order(order_date);
CREATE INDEX idx_sales_order_date ON tb_sales_order(order_date);
```

### 7.5 ç´¢å¼•ä¼˜åŒ–ç­–ç•¥
- **é€‰æ‹©æ€§é«˜çš„å­—æ®µ**ï¼šä¼˜å…ˆä¸ºé€‰æ‹©æ€§é«˜çš„å­—æ®µåˆ›å»ºç´¢å¼•
- **æŸ¥è¯¢é¢‘ç‡**ï¼šä¸ºç»å¸¸æŸ¥è¯¢çš„å­—æ®µåˆ›å»ºç´¢å¼•
- **å¤åˆç´¢å¼•é¡ºåº**ï¼šæŒ‰ç…§æŸ¥è¯¢æ¡ä»¶çš„ä½¿ç”¨é¢‘ç‡æ’åº
- **ç´¢å¼•ç»´æŠ¤**ï¼šå®šæœŸåˆ†æç´¢å¼•ä½¿ç”¨æƒ…å†µï¼Œåˆ é™¤æ— ç”¨ç´¢å¼•

---

## 8. ç³»ç»ŸåŠŸèƒ½å®ç°

### 8.1 æŠ€æœ¯æ¶æ„

#### 8.1.1 åç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šSpring Boot 2.5.x
- **å®‰å…¨**ï¼šSpring Security + JWT
- **æ•°æ®è®¿é—®**ï¼šMyBatis + MyBatis-Plus
- **æ•°æ®åº“**ï¼šOpenGaussï¼ˆå…¼å®¹PostgreSQLï¼‰
- **ç¼“å­˜**ï¼šRedis
- **å·¥å…·**ï¼šDruidè¿æ¥æ± ã€PageHelperåˆ†é¡µ

#### 8.1.2 å‰ç«¯æŠ€æœ¯æ ˆ
- **æ¡†æ¶**ï¼šVue 3.x + Element Plus
- **æ„å»ºå·¥å…·**ï¼šVite
- **çŠ¶æ€ç®¡ç†**ï¼šPinia
- **è·¯ç”±**ï¼šVue Router
- **HTTPå®¢æˆ·ç«¯**ï¼šAxios

### 8.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### 8.2.1 å›¾ä¹¦ç®¡ç†æ¨¡å—
**Controllerå±‚å®ç°**ï¼š
```java
@RestController
@RequestMapping("/manage/book")
public class TbBookController extends BaseController {
    @Autowired
    private ITbBookService tbBookService;
    
    @PreAuthorize("@ss.hasPermi('manage:book:list')")
    @GetMapping("/list")
    public TableDataInfo list(TbBook tbBook) {
        startPage();
        List<TbBook> list = tbBookService.selectTbBookList(tbBook);
        return getDataTable(list);
    }
    
    @PreAuthorize("@ss.hasPermi('manage:book:add')")
    @PostMapping
    public AjaxResult add(@RequestBody TbBook tbBook) {
        return toAjax(tbBookService.insertTbBook(tbBook));
    }
}
```

**Serviceå±‚å®ç°**ï¼š
```java
@Service
public class TbBookServiceImpl implements ITbBookService {
    @Autowired
    private TbBookMapper tbBookMapper;
    
    @Override
    public List<TbBook> selectTbBookList(TbBook tbBook) {
        return tbBookMapper.selectTbBookList(tbBook);
    }
    
    @Override
    public int insertTbBook(TbBook tbBook) {
        return tbBookMapper.insertTbBook(tbBook);
    }
}
```

#### 8.2.2 è¿›è´§ç®¡ç†æ¨¡å—
**ä¸»ä»è¡¨å…³è”å¤„ç†**ï¼š
```java
@Service
public class TbPurchaseOrderServiceImpl implements ITbPurchaseOrderService {
    @Override
    @Transactional
    public int insertTbPurchaseOrder(TbPurchaseOrder tbPurchaseOrder) {
        int rows = tbPurchaseOrderMapper.insertTbPurchaseOrder(tbPurchaseOrder);
        insertTbPurchaseDetail(tbPurchaseOrder);
        return rows;
    }
    
    public void insertTbPurchaseDetail(TbPurchaseOrder tbPurchaseOrder) {
        List<TbPurchaseDetail> tbPurchaseDetailList = tbPurchaseOrder.getTbPurchaseDetailList();
        Long orderId = tbPurchaseOrder.getOrderId();
        if (StringUtils.isNotNull(tbPurchaseDetailList)) {
            for (TbPurchaseDetail tbPurchaseDetail : tbPurchaseDetailList) {
                tbPurchaseDetail.setOrderId(orderId);
            }
            tbPurchaseDetailMapper.batchTbPurchaseDetail(tbPurchaseDetailList);
        }
    }
}
```

#### 8.2.3 é”€å”®ç®¡ç†æ¨¡å—
**åº“å­˜æ£€æŸ¥ä¸æ›´æ–°**ï¼š
```java
@Service
public class TbSalesOrderServiceImpl implements ITbSalesOrderService {
    @Override
    @Transactional
    public int insertTbSalesOrder(TbSalesOrder tbSalesOrder) {
        // æ£€æŸ¥åº“å­˜
        checkInventory(tbSalesOrder.getTbSalesDetailList());
        
        int rows = tbSalesOrderMapper.insertTbSalesOrder(tbSalesOrder);
        insertTbSalesDetail(tbSalesOrder);
        return rows;
    }
    
    private void checkInventory(List<TbSalesDetail> salesDetails) {
        for (TbSalesDetail detail : salesDetails) {
            TbBook book = tbBookMapper.selectTbBookByBookId(detail.getBookId());
            if (book.getTotalStock() < detail.getQuantity()) {
                throw new ServiceException("åº“å­˜ä¸è¶³ï¼š" + book.getTitle());
            }
        }
    }
}
```

#### 8.2.4 ç»Ÿè®¡åˆ†ææ¨¡å—
**Dashboardç»Ÿè®¡æœåŠ¡**ï¼š
```java
@Service
public class DashboardServiceImpl implements IDashboardService {
    @Autowired
    private DashboardMapper dashboardMapper;
    
    @Override
    public Map<String, Object> getBasicStats() {
        Map<String, Object> stats = new HashMap<>();
        stats.put("totalBooks", dashboardMapper.getTotalBooks());
        stats.put("totalInventory", dashboardMapper.getTotalInventory());
        stats.put("totalCategories", dashboardMapper.getTotalCategories());
        stats.put("totalWarehouses", dashboardMapper.getTotalWarehouses());
        return stats;
    }
    
    @Override
    public List<Map<String, Object>> getHotBooks(int limit) {
        return dashboardMapper.getHotBooks(limit);
    }
}
```

### 8.3 å‰ç«¯åŠŸèƒ½å®ç°

#### 8.3.1 å›¾ä¹¦ç®¡ç†ç•Œé¢
```vue
<template>
  <div class="app-container">
    <!-- æŸ¥è¯¢æ¡ä»¶ -->
    <el-form :model="queryParams" ref="queryRef" :inline="true">
      <el-form-item label="ä¹¦ç±åç§°" prop="title">
        <el-input v-model="queryParams.title" placeholder="è¯·è¾“å…¥ä¹¦ç±åç§°" />
      </el-form-item>
      <el-form-item>
        <el-button type="primary" icon="Search" @click="handleQuery">æœç´¢</el-button>
        <el-button icon="Refresh" @click="resetQuery">é‡ç½®</el-button>
      </el-form-item>
    </el-form>
    
    <!-- æ•°æ®è¡¨æ ¼ -->
    <el-table v-loading="loading" :data="bookList">
      <el-table-column label="å›¾ä¹¦ID" align="center" prop="bookId" />
      <el-table-column label="ä¹¦ç±åç§°" align="center" prop="title" />
      <el-table-column label="ä½œè€…åç§°" align="center" prop="author" />
      <el-table-column label="è¿›è´§ä»·" align="center" prop="purchasePrice" />
      <el-table-column label="é›¶å”®ä»·" align="center" prop="retailPrice" />
      <el-table-column label="æ€»åº“å­˜" align="center" prop="totalStock" />
      <el-table-column label="æ“ä½œ" align="center">
        <template #default="scope">
          <el-button type="primary" @click="handleUpdate(scope.row)">ä¿®æ”¹</el-button>
          <el-button type="danger" @click="handleDelete(scope.row)">åˆ é™¤</el-button>
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>
```

#### 8.3.2 è¿›è´§ç®¡ç†ç•Œé¢
```vue
<template>
  <div class="app-container">
    <!-- ä¸»è¡¨ä¿¡æ¯ -->
    <el-form :model="form" ref="formRef">
      <el-form-item label="è¿›è´§æ—¥æœŸ" prop="orderDate">
        <el-date-picker v-model="form.orderDate" type="date" />
      </el-form-item>
    </el-form>
    
    <!-- æ˜ç»†è¡¨æ ¼ -->
    <el-table :data="form.tbPurchaseDetailList">
      <el-table-column label="å›¾ä¹¦" prop="bookId">
        <template #default="scope">
          <el-select v-model="scope.row.bookId">
            <el-option v-for="book in bookList" :key="book.bookId" 
                      :label="book.title" :value="book.bookId" />
          </el-select>
        </template>
      </el-table-column>
      <el-table-column label="ä»“åº“" prop="warehouseId">
        <template #default="scope">
          <el-select v-model="scope.row.warehouseId">
            <el-option v-for="warehouse in warehouseList" :key="warehouse.warehouseId" 
                      :label="warehouse.warehouseName" :value="warehouse.warehouseId" />
          </el-select>
        </template>
      </el-table-column>
      <el-table-column label="æ•°é‡" prop="quantity">
        <template #default="scope">
          <el-input v-model="scope.row.quantity" type="number" />
        </template>
      </el-table-column>
    </el-table>
  </div>
</template>
```

### 8.4 æ•°æ®è®¿é—®å±‚å®ç°

#### 8.4.1 MyBatisæ˜ å°„æ–‡ä»¶
```xml
<mapper namespace="com.ruoyi.manage.mapper.TbBookMapper">
    <resultMap type="TbBook" id="TbBookResult">
        <result property="bookId" column="book_id" />
        <result property="title" column="title" />
        <result property="author" column="author" />
        <result property="categoryId" column="category_id" />
        <result property="publisherId" column="publisher_id" />
        <result property="purchasePrice" column="purchase_price" />
        <result property="retailPrice" column="retail_price" />
        <result property="totalStock" column="total_stock" />
    </resultMap>
    
    <select id="selectTbBookList" parameterType="TbBook" resultMap="TbBookResult">
        SELECT book_id, title, author, category_id, publisher_id, 
               purchase_price, retail_price, total_stock
        FROM tb_book
        <where>
            <if test="title != null and title != ''">AND title LIKE CONCAT('%', #{title}, '%')</if>
            <if test="author != null and author != ''">AND author LIKE CONCAT('%', #{author}, '%')</if>
            <if test="categoryId != null">AND category_id = #{categoryId}</if>
        </where>
        ORDER BY book_id
    </select>
</mapper>
```

---

## 9. ç³»ç»Ÿç•Œé¢çš„å‹å¥½æ€§

### 9.1 ç•Œé¢è®¾è®¡åŸåˆ™

#### 9.1.1 ä¸€è‡´æ€§åŸåˆ™
- ç»Ÿä¸€çš„è‰²å½©æ­é…å’Œè§†è§‰é£æ ¼
- ä¸€è‡´çš„äº¤äº’æ¨¡å¼å’Œæ“ä½œä¹ æƒ¯
- ç»Ÿä¸€çš„å›¾æ ‡å’ŒæŒ‰é’®æ ·å¼
- ä¸€è‡´çš„å¸ƒå±€ç»“æ„

#### 9.1.2 ç®€æ´æ€§åŸåˆ™
- æ¸…æ™°çš„ä¿¡æ¯å±‚æ¬¡ç»“æ„
- ç®€æ´æ˜äº†çš„ç•Œé¢å¸ƒå±€
- é¿å…å†—ä½™ä¿¡æ¯å’Œå¤æ‚æ“ä½œ
- çªå‡ºæ ¸å¿ƒåŠŸèƒ½

### 9.2 ç”¨æˆ·ä½“éªŒä¼˜åŒ–

#### 9.2.1 å“åº”å¼è®¾è®¡
- æ”¯æŒå¤šç§å±å¹•å°ºå¯¸
- è‡ªé€‚åº”å¸ƒå±€è°ƒæ•´
- ç§»åŠ¨ç«¯å‹å¥½ç•Œé¢
- è§¦æ‘¸æ“ä½œä¼˜åŒ–

#### 9.2.2 äº¤äº’ä½“éªŒ
- å¿«é€Ÿå“åº”çš„æ“ä½œåé¦ˆ
- æ¸…æ™°çš„çŠ¶æ€æç¤º
- å‹å¥½çš„é”™è¯¯æç¤ºä¿¡æ¯
- ä¾¿æ·çš„å¿«æ·é”®æ”¯æŒ

### 9.3 ç•Œé¢åŠŸèƒ½ç‰¹æ€§

#### 9.3.1 é¦–é¡µDashboard
```vue
<template>
  <div class="app-container home">
    <!-- æ¬¢è¿ä¿¡æ¯ -->
    <el-row :gutter="20">
      <el-col :sm="24" :lg="16">
        <h2>ğŸ“š ä¹¦åº—è¿›è´§é”€å”®ç®¡ç†ç³»ç»Ÿ</h2>
        <p>æ¬¢è¿ä½¿ç”¨ä¹¦åº—è¿›è´§é”€å”®ç®¡ç†ç³»ç»Ÿï¼æœ¬ç³»ç»ŸåŸºäºè‹¥ä¾æ¡†æ¶å¼€å‘ï¼Œä¸“ä¸ºä¹¦åº—ä¸šåŠ¡é‡èº«å®šåˆ¶...</p>
        <p>
          <el-tag type="success">ğŸ“– å›¾ä¹¦ç®¡ç†</el-tag>
          <el-tag type="primary">ğŸ“¦ åº“å­˜ç®¡ç†</el-tag>
          <el-tag type="warning">ğŸ’° é”€å”®ç»Ÿè®¡</el-tag>
        </p>
      </el-col>
    </el-row>
    
    <!-- ç»Ÿè®¡å¡ç‰‡ -->
    <el-row :gutter="20" class="panel-group">
      <el-col :xs="12" :sm="12" :lg="6">
        <div class="panel panel-mini">
          <div class="panel-icon">ğŸ“š</div>
          <div class="panel-content">
            <div class="panel-title">å›¾ä¹¦æ€»æ•°</div>
            <div class="panel-value">{{ stats.totalBooks }}</div>
          </div>
        </div>
      </el-col>
    </el-row>
  </div>
</template>
```

#### 9.3.2 æ•°æ®è¡¨æ ¼ä¼˜åŒ–
- åˆ†é¡µæ˜¾ç¤ºå¤§é‡æ•°æ®
- æ’åºå’Œç­›é€‰åŠŸèƒ½
- æ‰¹é‡æ“ä½œæ”¯æŒ
- å¯¼å‡ºåŠŸèƒ½

#### 9.3.3 è¡¨å•è®¾è®¡
- æ¸…æ™°çš„å­—æ®µæ ‡ç­¾
- åˆç†çš„è¾“å…¥éªŒè¯
- å®æ—¶é”™è¯¯æç¤º
- è‡ªåŠ¨ä¿å­˜åŠŸèƒ½

### 9.4 å¯è®¿é—®æ€§è®¾è®¡

#### 9.4.1 é”®ç›˜å¯¼èˆª
- æ”¯æŒTabé”®å¯¼èˆª
- å¿«æ·é”®æ“ä½œ
- ç„¦ç‚¹ç®¡ç†

#### 9.4.2 è§†è§‰è¾…åŠ©
- é«˜å¯¹æ¯”åº¦æ¨¡å¼
- å­—ä½“å¤§å°è°ƒèŠ‚
- è‰²å½©åŒºåˆ†æ˜æ˜¾

### 9.5 æ€§èƒ½ä¼˜åŒ–

#### 9.5.1 å‰ç«¯ä¼˜åŒ–
- ç»„ä»¶æ‡’åŠ è½½
- å›¾ç‰‡æ‡’åŠ è½½
- ä»£ç åˆ†å‰²
- ç¼“å­˜ç­–ç•¥

#### 9.5.2 ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- åŠ è½½çŠ¶æ€æç¤º
- éª¨æ¶å±æ˜¾ç¤º
- é”™è¯¯è¾¹ç•Œå¤„ç†
- ç¦»çº¿æç¤º

---

## æ€»ç»“

æœ¬ä¹¦åº—å›¾ä¹¦è¿›è´§é”€å”®ç®¡ç†ç³»ç»ŸåŸºäºç°ä»£åŒ–çš„æŠ€æœ¯æ¶æ„ï¼Œå®ç°äº†å®Œæ•´çš„ä¸šåŠ¡æµç¨‹ç®¡ç†ã€‚ç³»ç»Ÿåœ¨æ•°æ®åº“è®¾è®¡ã€å®‰å…¨æ€§ã€å®Œæ•´æ€§ã€ç”¨æˆ·ä½“éªŒç­‰æ–¹é¢éƒ½è¿›è¡Œäº†å……åˆ†çš„è€ƒè™‘å’Œä¼˜åŒ–ã€‚é€šè¿‡è§†å›¾ã€è§¦å‘å™¨ã€å­˜å‚¨è¿‡ç¨‹ç­‰æ•°æ®åº“ç‰¹æ€§çš„åˆç†è¿ç”¨ï¼Œç¡®ä¿äº†æ•°æ®çš„ä¸€è‡´æ€§å’Œä¸šåŠ¡é€»è¾‘çš„æ­£ç¡®æ€§ã€‚ç³»ç»Ÿç•Œé¢å‹å¥½ï¼ŒåŠŸèƒ½å®Œå–„ï¼Œèƒ½å¤Ÿæ»¡è¶³ä¹¦åº—æ—¥å¸¸ç»è¥ç®¡ç†çš„å„ç§éœ€æ±‚ã€‚

### é¡¹ç›®äº®ç‚¹
1. **å®Œæ•´çš„ä¸šåŠ¡æµç¨‹**ï¼šè¦†ç›–å›¾ä¹¦ç®¡ç†ã€è¿›è´§ã€é”€å”®ã€åº“å­˜ç­‰å…¨ä¸šåŠ¡æµç¨‹
2. **æ•°æ®ä¸€è‡´æ€§ä¿è¯**ï¼šé€šè¿‡è§¦å‘å™¨è‡ªåŠ¨ç»´æŠ¤åº“å­˜æ•°æ®ä¸€è‡´æ€§
3. **æƒé™å®‰å…¨æ§åˆ¶**ï¼šåŸºäºRBACçš„ç»†ç²’åº¦æƒé™æ§åˆ¶
4. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–**ï¼šç°ä»£åŒ–çš„å‰ç«¯ç•Œé¢å’Œè‰¯å¥½çš„äº¤äº’ä½“éªŒ
5. **æ•°æ®åº“ä¼˜åŒ–**ï¼šåˆç†çš„ç´¢å¼•è®¾è®¡å’ŒæŸ¥è¯¢ä¼˜åŒ–
6. **æ‰©å±•æ€§è‰¯å¥½**ï¼šæ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•å’Œç»´æŠ¤

### æŠ€æœ¯ç‰¹è‰²
- å‰åç«¯åˆ†ç¦»æ¶æ„
- å¾®æœåŠ¡è®¾è®¡ç†å¿µ
- æ•°æ®åº“äº‹åŠ¡ç®¡ç†
- ç¼“å­˜æœºåˆ¶ä¼˜åŒ–
- å“åº”å¼ç•Œé¢è®¾è®¡
- å›½é™…åŒ–æ”¯æŒ